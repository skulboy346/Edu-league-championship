<!-- ... (Head and Body HTML same as previous, just updating script) ... -->
    <!-- Firebase & Logic Script -->
    <script type="module">
        // ... (Imports, Config, State, DOM Elements same as before) ...

        // ... (Custom Alert, Add/Remove Player same as before) ...

        // ... (Save Roster logic same as before) ...
        
        window.goToHome = function() {
            // Redirect to index.html and add status=complete
            // Also clear storage as they are done
            localStorage.removeItem('eduLeagueTeamID');
            window.location.assign(`./index.html?status=complete`);
        }
        
        // --- Page Load Logic ---
        async function loadTeamData() {
            const params = new URLSearchParams(window.location.search);
            teamDocId = params.get('teamId');
            
            // ** NEW: Recovery Logic **
            if (!teamDocId) {
                const savedId = localStorage.getItem('eduLeagueTeamID');
                if (savedId) {
                    teamDocId = savedId;
                    console.log("Recovered Team ID from storage:", teamDocId);
                } else {
                    console.error("Team ID is missing!");
                    showCustomAlert("Error", "Session expired. Please go back to registration.");
                    teamNameDisplay.textContent = "Error: Session Lost";
                    document.getElementById('rosterForm').classList.add('hidden');
                    return;
                }
            } else {
                // Save valid ID
                localStorage.setItem('eduLeagueTeamID', teamDocId);
            }

            await initializeFirebase();
            // ... (Rest of logic same as before) ...
        }

        // ... (Initialize Firebase same as before) ...

    </script>
</body>
</html>